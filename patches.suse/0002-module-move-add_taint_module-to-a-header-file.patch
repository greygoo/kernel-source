From 638d472c32e1da6ff6fee819908f52f85606067a Mon Sep 17 00:00:00 2001
From: Miroslav Benes <mbenes@suse.cz>
Date: Mon, 5 Sep 2016 17:26:07 +0200
Subject: [PATCH 2/3] module: move add_taint_module() to a header file
Patch-mainline: not yet, kgraft
References: fate#313296

Move add_taint_module() to include/linux/module.h header file and thus
make it generally available.

Signed-off-by: Miroslav Benes <mbenes@suse.cz>
---
 include/linux/module.h |    7 +++++++
 kernel/module.c        |    7 -------
 2 files changed, 7 insertions(+), 7 deletions(-)

--- a/include/linux/module.h
+++ b/include/linux/module.h
@@ -423,6 +423,13 @@ static inline int within_module_init(uns
 	       addr < (unsigned long)mod->module_init + mod->init_size;
 }
 
+static inline void add_taint_module(struct module *mod, unsigned flag,
+				    enum lockdep_ok lockdep_ok)
+{
+	add_taint(flag, lockdep_ok);
+	mod->taints |= (1U << flag);
+}
+
 /* Search for module by name: must hold module_mutex. */
 struct module *find_module(const char *name);
 
--- a/kernel/module.c
+++ b/kernel/module.c
@@ -217,13 +217,6 @@ static inline int strong_try_module_get(
 		return -ENOENT;
 }
 
-static inline void add_taint_module(struct module *mod, unsigned flag,
-				    enum lockdep_ok lockdep_ok)
-{
-	add_taint(flag, lockdep_ok);
-	mod->taints |= (1U << flag);
-}
-
 /*
  * A thread that wants to hold a reference to a module only while it
  * is running can call this to safely exit.  nfsd and lockd use this.
